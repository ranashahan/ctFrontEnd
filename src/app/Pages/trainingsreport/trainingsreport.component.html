<div class="container-fluid margintop">
  <hr />
  <div class="row">
    <div class="col-auto">
      <img
        src="img/report.jpg"
        alt="TrainingReport"
        width="180px"
        height="180px"
      />
    </div>
    <div class="col-auto">
      <h2>Training Reports</h2>
      <p>You can download report by selection:</p>
    </div>
  </div>
  <hr />
  <app-toast></app-toast>
  <div class="row">
    <div class="col-lg-6 col-md-6 col-sm-12">
      <div class="card mb-4">
        <div class="card-body bg-primary bg-opacity-50">
          <h5 class="card-title">Yearly Trainings Count</h5>
          <div id="chart1">
            <apx-chart
              [series]="trendTrainings.series"
              [chart]="trendTrainings.chart"
              [dataLabels]="trendTrainings.dataLabels"
              [plotOptions]="trendTrainings.plotOptions"
              [yaxis]="trendTrainings.yaxis"
              [xaxis]="trendTrainings.xaxis"
              [fill]="trendTrainings.fill"
              [title]="trendTrainings.title"
            ></apx-chart>
          </div>
        </div>
      </div>
    </div>
    <div class="col-lg-6 col-md-6 col-sm-12">
      <div class="card mb-4">
        <div class="card-body bg-primary bg-opacity-50">
          <h5 class="card-title">Yearly Clients Trainings</h5>
          <div id="chart2">
            <apx-chart
              [series]="trendTrainingsStacked.series"
              [chart]="trendTrainingsStacked.chart"
              [dataLabels]="trendTrainingsStacked.dataLabels"
              [plotOptions]="trendTrainingsStacked.plotOptions"
              [responsive]="trendTrainingsStacked.responsive"
              [xaxis]="trendTrainingsStacked.xaxis"
              [legend]="trendTrainingsStacked.legend"
              [fill]="trendTrainingsStacked.fill"
            ></apx-chart>
          </div>
        </div>
      </div>
    </div>
  </div>
  <hr />
  <div class="row">
    <div class="col-lg-12 col-md-12 col-sm-12">
      <div class="card mb-4">
        <div class="card-body bg-primary bg-opacity-50">
          <h5 class="card-title">Training Report All</h5>
          <form [formGroup]="formAll">
            <div class="row my-2">
              <div class="col-auto">
                <div class="form-floating mb-3">
                  <input
                    type="date"
                    class="form-control form-control-sm border border-primary border-3"
                    id="floatingAllFrom"
                    formControlName="startDate"
                  />
                  <label for="floatingAllFrom">From</label>
                </div>
              </div>
              <div class="col-auto">
                <div class="form-floating">
                  <input
                    type="date"
                    class="form-control form-control-sm border border-primary border-3"
                    id="floatingAllTo"
                    formControlName="endDate"
                  />
                  <label for="floatingAllTo">To</label>
                </div>
              </div>
              <div class="col-auto">
                <div class="form-floating">
                  <select
                    class="form-select form-select-sm border border-primary border-3"
                    id="floatingAllSelectcourse"
                    formControlName="courseid"
                  >
                    <option disabled value="null">-----Select-----</option>
                    @for (item of courses(); track $index) {
                    <option [value]="item.id">{{ item.name }}</option>
                    }
                  </select>
                  <label for="floatingAllSelectcourse">Course</label>
                </div>
              </div>
              <div class="col-auto">
                <div class="form-floating">
                  <select
                    class="form-select form-select-sm border border-primary border-3"
                    id="floatingAllSelectcategory"
                    formControlName="categoryid"
                  >
                    <option disabled value="null">-----Select-----</option>
                    @for (item of categories(); track $index) {
                    <option [value]="item.id">{{ item.name }}</option>
                    }
                  </select>
                  <label for="floatingAllSelectcategory">Category</label>
                </div>
              </div>
              <div class="col-auto">
                <div class="form-floating">
                  <select
                    class="form-select form-select-sm border border-primary border-3"
                    id="floatingAllSelectTitle"
                    formControlName="titleid"
                  >
                    <option disabled value="null">-----Select-----</option>
                    @for (item of titles(); track $index) {
                    <option [value]="item.id">{{ item.name }}</option>
                    }
                  </select>
                  <label for="floatingAllSelectTitle">Program</label>
                </div>
              </div>
              <div class="col-auto">
                <div class="form-floating">
                  <select
                    class="form-select form-select-sm border border-primary border-3"
                    id="floatingAllSelectLocation"
                    formControlName="locationid"
                  >
                    <option disabled value="null">-----Select-----</option>
                    @for (item of locations(); track $index) {
                    <option [value]="item.id">{{ item.name }}</option>
                    }
                  </select>
                  <label for="floatingAllSelectLocation">Locations</label>
                </div>
              </div>
              <div class="col-auto">
                <div class="form-floating">
                  <select
                    class="form-select form-select-sm border border-primary border-3"
                    id="floatingAllSelectSources"
                    formControlName="source"
                  >
                    <option disabled value="null">-----Select-----</option>
                    @for (item of sources(); track $index) {
                    <option [value]="item">{{ item }}</option>
                    }
                  </select>
                  <label for="floatingAllSelectSources">Source</label>
                </div>
              </div>
              <div class="col-auto">
                <div class="form-floating">
                  <select
                    class="form-select form-select-sm border border-primary border-3"
                    id="floatingAllSelectStatus"
                    formControlName="status"
                  >
                    <option disabled value="null">-----Select-----</option>
                    @for (item of statuses(); track $index) {
                    <option [value]="item">{{ item }}</option>
                    }
                  </select>
                  <label for="floatingAllSelectStatus">Status</label>
                </div>
              </div>
              <div class="col-auto">
                <div class="form-floating">
                  <select
                    class="form-select form-select-sm border border-primary border-3"
                    id="floatingAllSelectClient"
                    formControlName="clientid"
                  >
                    <option disabled value="null">-----Select-----</option>
                    @for (item of clients(); track $index) {
                    <option [value]="item.id">{{ item.name }}</option>
                    }
                  </select>
                  <label for="floatingAllSelectClient">Sponsor</label>
                </div>
              </div>

              <div class="col-auto">
                <div class="form-floating">
                  <select
                    class="form-select form-select-sm border border-primary border-3"
                    id="floatingSelectContractor"
                    formControlName="contractorid"
                  >
                    <option disabled value="null">-----Select-----</option>
                    @for (item of filteredContractors(); track $index) {
                    <option [value]="item.id">{{ item.name }}</option>
                    }
                  </select>
                  <label for="floatingSelectContractor">Contractors</label>
                </div>
              </div>
              <div class="col-auto">
                <div class="form-floating">
                  <select
                    class="form-select form-select-sm border border-primary border-3"
                    id="floatingSelectTrainer"
                    formControlName="trainerid"
                  >
                    <option disabled value="null">-----Select-----</option>
                    @for (item of trainers(); track $index) {
                    <option [value]="item.id">{{ item.name }}</option>
                    }
                  </select>
                  <label for="floatingSelectTrainer">Trainers</label>
                </div>
              </div>
              <div class="col-auto">
                @if (apiCallInProgress()) {
                <button class="btn btn-primary" type="button" disabled>
                  <span
                    class="spinner-grow spinner-grow-sm"
                    aria-hidden="true"
                  ></span>
                  <span role="status"> Loading...</span>
                </button>
                }@else {
                <button
                  type="submit"
                  class="btn btn-primary"
                  (click)="getReportALL()"
                >
                  <i class="fa-solid fa-file-excel"></i>
                  Export
                </button>

                <button
                  type="button"
                  class="btn btn-secondary mx-1"
                  (click)="resetForm()"
                >
                  <i class="fa-solid fa-broom"></i> Reset
                </button>
                }
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-lg-3 col-md-6 col-sm-12">
      <form [formGroup]="formFinance">
        <div class="card mb-4">
          <div class="card-body bg-primary bg-opacity-50">
            <h5 class="card-title">Financial Report By Month</h5>
            <div class="card-text">
              <div class="row g-3 align-items-center">
                <div class="col-auto">
                  <div class="form-floating">
                    <select
                      class="form-select form-select-sm border border-primary border-3"
                      id="floatingAllSelectmonth"
                      formControlName="month"
                    >
                      <option disabled value="null">-----Select-----</option>
                      @for (item of months(); track $index) {
                      <option [value]="item.id">{{ item.name }}</option>
                      }
                    </select>
                    <label for="floatingAllSelectmonth">Month</label>
                  </div>
                </div>
                <div class="col-auto">
                  <div class="form-floating">
                    <select
                      class="form-select form-select-sm border border-primary border-3"
                      id="floatingAllSelectyear"
                      formControlName="year"
                    >
                      <option disabled value="null">-----Select-----</option>
                      @for (item of years(); track $index) {
                      <option [value]="item">{{ item }}</option>
                      }
                    </select>
                    <label for="floatingAllSelectyear">Year</label>
                  </div>
                </div>
              </div>
            </div>
            <p class="card-text mt-1">
              <button
                class="btn btn-primary"
                type="submit"
                title="Export Financial Report"
                (click)="exportFinance()"
                [disabled]="formFinance.invalid"
              >
                <i class="fa-solid fa-file-excel"></i> Export
              </button>
              <button
                class="btn btn-secondary ms-1"
                (click)="resetForm()"
                title="Reset Filter"
              >
                <i class="fa-solid fa-broom"></i> Reset
              </button>
            </p>
          </div>
        </div>
      </form>
    </div>
    <div class="col-lg-3 col-md-6 col-sm-12">
      <div class="card mb-4">
        <div class="card-body bg-primary bg-opacity-50">
          <h5 class="card-title">Training Report</h5>
          <p class="card-text">
            <select
              class="form-select form-select-sm border border-primary border-3"
              id="driverexpiry2"
            >
              <option selected>-----Select-----</option>
            </select>
          </p>
          <p class="card-text">
            <button class="btn btn-primary" title="Export">
              <i class="fa-solid fa-file-excel"></i> Export
            </button>
            <button class="btn btn-secondary ms-1" title="Reset Filter">
              <i class="fa-solid fa-broom"></i> Reset
            </button>
          </p>
        </div>
      </div>
    </div>
    <div class="col-lg-3 col-md-6 col-sm-12">
      <div class="card mb-4">
        <div class="card-body bg-primary bg-opacity-50">
          <h5 class="card-title">Training Report</h5>
          <p class="card-text">
            <select
              class="form-select form-select-sm border border-primary border-3"
              id="driverexpiry3"
            >
              <option selected>-----Select-----</option>
            </select>
          </p>
          <p class="card-text">
            <button class="btn btn-primary" title="Export">
              <i class="fa-solid fa-file-excel"></i> Export
            </button>
            <button class="btn btn-secondary ms-1" title="Reset Filter">
              <i class="fa-solid fa-broom"></i> Reset
            </button>
          </p>
        </div>
      </div>
    </div>
    <div class="col-lg-3 col-md-6 col-sm-12">
      <div class="card mb-4">
        <div class="card-body bg-primary bg-opacity-50">
          <h5 class="card-title">Training Report</h5>
          <p class="card-text">
            <select
              class="form-select form-select-sm border border-primary border-3"
              id="driverexpiry4"
            >
              <option selected>-----Select-----</option>
              <option value="To be built">To be built</option>
            </select>
          </p>
          <p class="card-text">
            <button class="btn btn-primary" title="Export ">
              <i class="fa-solid fa-file-excel"></i> Export
            </button>
            <button class="btn btn-secondary ms-1" title="Reset Filter">
              <i class="fa-solid fa-broom"></i> Reset
            </button>
          </p>
        </div>
      </div>
    </div>
  </div>
  <hr />
</div>
